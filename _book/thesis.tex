%******************************************************************************
% This borrows heavily from a LaTeX template for Queen's theses
% developed by Bob Burke (BB), Dean Jin (DJ), Michelle L. Crane (MLC),
% and from the Reed College thesis template by Sam Noble (SN).
%******************************************************************************
% Template written in June 2021 for Queen's University requirements,
% to be used in the package 'eugensit/gaelsdown' by Eugene Sit (ESS),
% an adaptation of 'ismayc/thesisdown' developed by Chester Ismay (CII).
%******************************************************************************
% The pdf document (March 2017) listing the requirements for Queen's
% University theses has been added to this package as a reference.
%******************************************************************************

% *****************************************************************************
% PREAMBLE
% *****************************************************************************
%
% Required for all .tex files, points to appropriate .cls file.
% Set to one-sided according to Queen's University template rules.
\documentclass[12pt, oneside]{queensuthesis}
% Packages are extensions to the basic LaTeX functions. Whatever you
% want to typeset, there is probably a package out there for it.
% Chemistry (chemtex), screenplays, you name it.
% Check out CTAN to see: http://www.ctan.org/

\usepackage{graphicx}                  % including graphics
\usepackage{amsmath}                   % math notation
\numberwithin{equation}{chapter}       % equations will be numbered by section
\usepackage{chemarr} %% Useful for one reaction arrow, useless if you're not a chem major

\usepackage{amsthm}                    % theorem notation
\usepackage{cases}                     % to make numbered cases (equations)
\usepackage[hyphens]{url}              % allow breaks after url hyphens
\usepackage{rotating}                  % rotating figures and tables
\usepackage{longtable}                 % Warning: there may be issues with longtable and footer margins
\usepackage{booktabs}
\usepackage{setspace}                  % for use of \singlespacing and \doublespacing
\doublespacing

% Added by ESS

\usepackage[notlof,notlot,notbib]{tocbibind} % include ToC in ToC for easier navigation
\usepackage[defaultlines=3,all]{nowidow}     % avoid straggler lines at page breaks

\usepackage{etoolbox}
\preto\longtable{\par\singlespacing}
\preto\caption{\par\singlespacing}

% packages to support kableExtra
\usepackage{array}
\usepackage{multirow}
\usepackage{wrapfig}
\usepackage{colortbl}
\usepackage{pdflscape}
\usepackage{tabu}
\usepackage{threeparttable}
\usepackage{threeparttablex}
\usepackage[normalem]{ulem}
\usepackage{makecell}

% End of ESS addition

% Added by CII
\usepackage{hyperref}                  % for links within the document
\usepackage{lmodern}                   % for fonts
\usepackage{float}                     % package for \floatplacement
% \floatplacement{figure}{H}             % {H} specifies to place figures "here"

% for formatting Table of Contents entry, example: Chapter 1 Introduction
\usepackage{tocloft}

% CII (Thanks, Hadley!)
% Use ref for internal links
\renewcommand{\hyperref}[2][???]{\autoref{#1}}
\def\chapterautorefname{Chapter}
\def\sectionautorefname{Section}
\def\subsectionautorefname{Subsection}

\usepackage{caption}                   % figure and table caption settings

% End of CII addition

\captionsetup{labelsep=period, labelfont=bf, width=6in, font=footnotesize}

% \usepackage{times} % other fonts are available like times, bookman, charter, palatino

% the following code allows pandoc to inject code highlighting environments, e.g. Shaded.
% h/t coatless
  \usepackage{color}
  \usepackage{fancyvrb}
  \newcommand{\VerbBar}{|}
  \newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
  \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
  % Add ',fontsize=\small' for more characters per line
  \usepackage{framed}
  \definecolor{shadecolor}{RGB}{248,248,248}
  \newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
  \newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
  \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
  \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
  \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
  \newcommand{\BuiltInTok}[1]{#1}
  \newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
  \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
  \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
  \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
  \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
  \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
  \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
  \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
  \newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
  \newcommand{\ExtensionTok}[1]{#1}
  \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
  \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
  \newcommand{\ImportTok}[1]{#1}
  \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
  \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
  \newcommand{\NormalTok}[1]{#1}
  \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
  \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
  \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
  \newcommand{\RegionMarkerTok}[1]{#1}
  \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
  \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
  \newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
  \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
  \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
  \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
% added by ESS
% the following adds linebreaking to codeboxes and sets linespacing in these boxes to 1
% this is necessary due to the use of \doublespacing for the Queen's University template
  \usepackage{fvextra}
  \RecustomVerbatimEnvironment{Highlighting}{Verbatim}{
  breaklines,baselinestretch=1,commandchars=\\\{\},
  breaksymbolleft={},breakindentnchars=6
  }

% From {rticles}
\newlength{\csllabelwidth}
\setlength{\csllabelwidth}{3em}
\newlength{\cslhangindent}
\setlength{\cslhangindent}{1.5em}
% for Pandoc 2.8 to 2.10.1
\newenvironment{cslreferences}%
  {}%
  {\par}
% For Pandoc 2.11+
% As noted by @mirh [2] is needed instead of [3] for 2.12
\newenvironment{CSLReferences}[2] % #1 hanging-ident, #2 entry spacing
 {% don't indent paragraphs
  \setlength{\parindent}{0pt}
  % turn on hanging indent if param 1 is 1
  \ifodd #1 \everypar{\setlength{\hangindent}{\cslhangindent}}\ignorespaces\fi
  % set entry spacing
  \ifnum #2 > 0
  \setlength{\parskip}{#2\baselineskip}
  \fi
 }%
 {}
\usepackage{calc} % for calculating minipage widths
\newcommand{\CSLBlock}[1]{#1\hfill\break}
\newcommand{\CSLLeftMargin}[1]{\parbox[t]{\csllabelwidth}{#1}}
\newcommand{\CSLRightInline}[1]{\parbox[t]{\linewidth - \csllabelwidth}{#1}}
\newcommand{\CSLIndent}[1]{\hspace{\cslhangindent}#1}

\raggedbottom                          % Added by ESS

% Below sections by DJ/MLC

%******************************************************************************
% HEADINGS
%******************************************************************************

% This changes the headings go that they are prettier
% and can be commented out for traditional headings.
\usepackage{sectsty}

\allsectionsfont{\bfseries}            % set all the section font to bfseries
\chapterfont{\centering\Large}         % set the sizes of chapters, sections ...
\sectionfont{\normalsize}
\subsectionfont{\normalsize}

%******************************************************************************
% FOOTNOTES
%******************************************************************************

\interfootnotelinepenalty=10000 % This line stops footnotes from splitting onto two pages.

%******************************************************************************
% TITLE
%******************************************************************************

% Following sections added by CII
% Commands passed between YAML (index.Rmd) and LaTeX for title
% This tells LaTeX where to look for the info

\title{My Thesis}
\author{Your R. Name}
\dept{Department of Excellence}
\degree{Winner of Science}
\submitdate{May 20xx}
\copyrightyear{20xx}

% Copied from knitr
% maxwidth is the original width if it's less than linewidth
% otherwise use linewidth (to make sure the graphics do not exceed the margin)
\makeatletter
\def\maxwidth{ %
  \ifdim\Gin@nat@width>\linewidth
    \linewidth
  \else
    \Gin@nat@width
  \fi
}
\makeatother

\renewcommand{\contentsname}{Table of Contents}

\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
% End of CII addition

\setlength{\parskip}{0pt}

%******************************************************************************
% DOCUMENT
%******************************************************************************
%
% Content of the thesis below; see corresponding sections in queensuthesis.cls
% for formatting instructions (ESS). Modify the included sections as necessary!
% Substitute Header/ToC entry in \prefacesection{}, and 
\begin{document}

% Everything below added by CII

\frontmatter                           % frontmatter pages are roman-numbered
\pagestyle{plain}                      % change to empty to remove page numbering

  \maketitle

  \prefacesection{Abstract}{This is a placeholder for including an abstract.

\par

Second paragraph of abstract starts here.}



  \prefacesection{Acknowledgements}{This package was possible thanks to the work of Chester Ismay in developing \textbf{thesisdown} and Yihui Xie and other contributors in developing \textbf{bookdown}. Further acknowledgements for the development of the LaTeX template can be found in the template.tex and queensuthesis.cls files.}

% toc and toc_depth arguments are passed along by the pdf_book function
% called from bookdown package in R
  \hypersetup{linkcolor=black}
  \setcounter{tocdepth}{2}
  \tableofcontents
  \clearpage


  \listoffigures
  \addcontentsline{toc}{chapter}{List of Figures} % include a line in toc for lof
  \clearpage



\mainmatter % here the regular arabic numbering starts
\pagestyle{fancy} % turns page numbering back on

\hypertarget{introduction}{%
\chapter*{Introduction}\label{introduction}}
\addcontentsline{toc}{chapter}{Introduction}

\hypertarget{welcome}{%
\section*{Welcome}\label{welcome}}
\addcontentsline{toc}{section}{Welcome}

Welcome to the \textbf{gaelsdown} guide! This document is intended to get you up and running with writing your thesis in R markdown so that it can be published in a variety of formats, most importantly a PDF with formatting specifications in the TeX language.

In this \textbf{introduction chapter}, I'll run through the benefits of adopting \textbf{gaelsdown} into your writing process and what to expect, then explain the basics of how you get from a R markdown to a formatted pdf. Then, in the \textbf{first chapter} of the guide, I'll provide you with all the basic tools to put together a document with formatting, figures and tables, and a structure appropriate to your thesis. In the \textbf{second chapter}, I'll get into some of the more advanced methods for figures and tables, specifying formatting inline, and more. Finally, in the \textbf{third chapter}, I'll go over some common issues and how you can address them, as well as providing more resources and approaches for troubleshooting.

\hypertarget{motivation}{%
\section*{Motivation}\label{motivation}}
\addcontentsline{toc}{section}{Motivation}

The purpose of \textbf{gaelsdown} is to enable you to write your thesis in R markdown so that you can focus on the content of your thesis. With R markdown, you can insert code for figures, tables, and references at ease, then transform the markdown file into a finished, formatted document that meets the specifications provided by the School of Graduate Studies. This is a departure from what may be a more familiar approach of using R to generate tables and figures separately, then inserting those into a ``What-You-See-Is-What-You-Get'' (WYSIWYG) editor like Microsoft Word.

There's a number of \textbf{advantages} to this approach over using a WYSIWYG editor, including:
\begin{itemize}
\tightlist
\item
  Your R code and writing are streamlined into one document, so that changes to figures and tables are automatically integrated whenever you knit your document, and the bibliography and table of contents are automatically generated.
\item
  R markdown is a much more lightweight format to work in, which reduces the load on your computer significantly if your thesis has hundreds of pages and includes many figures.
\item
  The files making up your thesis are in plain text formats that can be easily transferred between platforms and require only free, open source software.
\item
  By using LaTeX to generate your document, you have access to a wide range of packages to support different types of mathematical and scientific formulas and a professional-quality typesetting engine, superior to Microsoft Word.
\item
  Many journals make .tex templates available for authors, which can help with submission. There are also several options for converting from a LaTeX document to a Word-compatible format.
\item
  If you're writing a thesis for Queen's University, the formatting of the PDF output already conforms to the specifications that the school has published. If you're writing for another school, or if you'd like to change some of the formatting, changes can be made in one place that apply to the whole document.
\end{itemize}
However, there are some potential challenges with writing your thesis in R markdown, especially if this is a new approach for you. This guide will help with avoiding or anticipating some of these challenges, but be aware of the following:
\begin{itemize}
\tightlist
\item
  Introducing formatting changes into a LaTeX document is a different process than in a WYSIWYG editor, and involves a bit of a learning curve. However, by using a template such as \textbf{gaelsdown}, you can avoid much of the LaTeX editing and focus on the content of your thesis.
\item
  \textbf{gaelsdown} relies on a few different programs when it knits together your document, which means there's a few different steps at which an error can be introduced. I'll explain what these steps are, and tips for addressing any issues encountered at each step.
\end{itemize}
\hypertarget{structure}{%
\section*{Structure}\label{structure}}
\addcontentsline{toc}{section}{Structure}

To understand how \textbf{gaelsdown} and similar template packages work, you need to understand the different software involved:
\begin{itemize}
\tightlist
\item
  \textbf{knitr} converts your R markdown file (.Rmd) into a markdown file (.md). The different between a R markdown file is that it includes R code chunks that need to be rendered as images for them to be markdown compatible.
\item
  \textbf{pandoc} is included with your RStudio install and is capable of converting between a large number of different text formats, including markdown, Word (.docx), web browser compatible (.html), and LaTeX (.tex).
\item
  \LaTeX~renders a typeset format such as PDF from .tex files---if you knit into another format such as gitbook or Word, LaTeX will not have been involved.
\end{itemize}
Here's a visualization of how it all flows together:
\begin{figure}
\centering
\includegraphics{thesis_files/figure-latex/knit-diagram-1.pdf}
\caption{\label{fig:knit-diagram}Illustration of document generation in gaelsdown, with inputs in red/orange rectangles, software in yellow ellipses, intermediate products in purple hexagons, and outputs a green rectangles.}
\end{figure}
If you knitted this document locally from the \textbf{gaelsdown} package and watched the console carefully, then you've already seen all these steps in action! You can run the knit again if you want to review it.

\hypertarget{getting-started}{%
\chapter{Getting started}\label{getting-started}}

If you've reached this step, you should have already installed the \textbf{gaelsdown} and \textbf{tinytex} packages and knit your first document (this one!). If not, first take a look at the \href{https://github.com/eugenesit/gaelsdown\#readme}{README} for instructions explaining these steps.

\hypertarget{writing-in-markdown}{%
\section{Writing in markdown}\label{writing-in-markdown}}

In \textbf{RStudio}, you write in \textbf{Pandoc Markdown} to generate publishable documents. That means this is a valuable skill even if you're not using a LaTeX template, and it's also an easy skill to pick up. The basic principle behind markdown is that it should be easy to read even in plain text, and it accomplishes this by using special characters in intuitive ways.

For example, to \emph{italicize} (emphasis) a word or line of text, you place it inside a pair of underscores or asterisks like so: \texttt{\_italicize\_}. To make a line \textbf{boldface} (strong emphasis), you put with two underscores or asterisks: \texttt{\_\_boldface\_\_}.

Where you start to get into real power of markdown is the ability to structure a document, such as by using headers. I mark the beginning of this chapter with a level-one header, \texttt{\#\ Getting\ started}, and the beginning of this section with a level-two header, \texttt{\#\#\ Writing\ in\ markdown}. If, say, we wanted to jump to another chapter, I could include a link using the header name \texttt{{[}Introduction{]}}: \protect\hyperlink{introduction}{Introduction}.

For a full primer on the features available in Pandoc Markdown, including the ability to insert lists, blockquotes, code chunks, and math, read \href{https://rmarkdown.rstudio.com/authoring_pandoc_markdown.html}{this tutorial}.

\hypertarget{figures-and-tables-in-r-markdown}{%
\section{Figures and tables in R markdown}\label{figures-and-tables-in-r-markdown}}

If you looked through the \href{https://rmarkdown.rstudio.com/authoring_pandoc_markdown.html}{Pandoc Markdown tutorial}, you may have noticed that there are features to include tables and images. However, the beauty of R markdown is that you can insert tables and figures using R code, then allow \textbf{knitr} to convert this code into a markdown format. To do this, I'll first need to load some R packages:
\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# List of packages required for this analysis}
\NormalTok{pkg }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"dplyr"}\NormalTok{, }\StringTok{"ggplot2"}\NormalTok{, }\StringTok{"knitr"}\NormalTok{, }\StringTok{"bookdown"}\NormalTok{, }\StringTok{"devtools"}\NormalTok{, }\StringTok{"DiagrammeR"}\NormalTok{)}
\CommentTok{\# Check if packages are not installed and assign the}
\CommentTok{\# names of the packages not installed to the variable new.pkg}
\NormalTok{new.pkg }\OtherTok{\textless{}{-}}\NormalTok{ pkg[}\SpecialCharTok{!}\NormalTok{(pkg }\SpecialCharTok{\%in\%} \FunctionTok{installed.packages}\NormalTok{())]}
\CommentTok{\# If there are any packages in the list that aren\textquotesingle{}t installed,}
\CommentTok{\# install them}
\ControlFlowTok{if}\NormalTok{ (}\FunctionTok{length}\NormalTok{(new.pkg))}
  \FunctionTok{install.packages}\NormalTok{(new.pkg, }\AttributeTok{repos =} \StringTok{"http://cran.rstudio.com"}\NormalTok{)}
\CommentTok{\# Load packages (This can be accomplished by just loading gaelsdown)}
\FunctionTok{library}\NormalTok{(gaelsdown)}
\end{Highlighting}
\end{Shaded}
Once the packages are loaded, I can assemble a basic table with R like so:
\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mtcars }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{head}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{kable}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{kable\_styling}\NormalTok{(}\AttributeTok{latex\_options =} \StringTok{"scale\_down"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}
\begin{table}
\centering
\resizebox{\linewidth}{!}{
\begin{tabular}{l|r|r|r|r|r|r|r|r|r|r|r}
\hline
  & mpg & cyl & disp & hp & drat & wt & qsec & vs & am & gear & carb\\
\hline
Mazda RX4 & 21.0 & 6 & 160 & 110 & 3.90 & 2.620 & 16.46 & 0 & 1 & 4 & 4\\
\hline
Mazda RX4 Wag & 21.0 & 6 & 160 & 110 & 3.90 & 2.875 & 17.02 & 0 & 1 & 4 & 4\\
\hline
Datsun 710 & 22.8 & 4 & 108 & 93 & 3.85 & 2.320 & 18.61 & 1 & 1 & 4 & 1\\
\hline
Hornet 4 Drive & 21.4 & 6 & 258 & 110 & 3.08 & 3.215 & 19.44 & 1 & 0 & 3 & 1\\
\hline
Hornet Sportabout & 18.7 & 8 & 360 & 175 & 3.15 & 3.440 & 17.02 & 0 & 0 & 3 & 2\\
\hline
Valiant & 18.1 & 6 & 225 & 105 & 2.76 & 3.460 & 20.22 & 1 & 0 & 3 & 1\\
\hline
\end{tabular}}
\end{table}
Alternatively, I may want to produce a plot:
\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(}\AttributeTok{data =}\NormalTok{ mtcars, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x =}\NormalTok{ wt, }\AttributeTok{y =}\NormalTok{ mpg)) }\SpecialCharTok{+}
  \FunctionTok{geom\_point}\NormalTok{() }\SpecialCharTok{+}
  \FunctionTok{theme\_classic}\NormalTok{()}
\end{Highlighting}
\end{Shaded}
\includegraphics{thesis_files/figure-latex/cars-figure-1.pdf}

I'll have some tips on how to make your tables and figures look great in the next chapter on \protect\hyperlink{additional-functions}{Additional functions}.

\hypertarget{math-equations-and-formulas}{%
\section{Math equations and formulas}\label{math-equations-and-formulas}}

One of the unique areas of strength of LaTeX is its support for writing equations and other scientific expressions, such as chemical formulas. For example, if you wanted to show the equation for the rate of population change, you would enter the following:

\texttt{\$\textbackslash{}frac\{dN\}\{dt\}\ =\ rN(1-\textbackslash{}frac\{N\}\{K\})\$}

Which produces:

\(\frac{dN}{dt} = rN(1-\frac{N}{K})\)

Equations can also be numbered and referred to, like figures or tables, by using the LaTeX command \texttt{\textbackslash{}begin\{equation\}}:
\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\textbackslash{}begin\{equation\}}
\FunctionTok{S}\NormalTok{(t) }\OtherTok{=}\NormalTok{ \textbackslash{}frac\{S\_\{max\}\}\{}\DecValTok{1} \SpecialCharTok{+}\NormalTok{ e}\SpecialCharTok{\^{}}\NormalTok{\{}\SpecialCharTok{{-}}\NormalTok{(t}\SpecialCharTok{{-}}\NormalTok{T\_\{i\}) }\SpecialCharTok{*}\NormalTok{ r\}\} \textbackslash{}label\{eq}\SpecialCharTok{:}\NormalTok{logistic\}}
\NormalTok{\textbackslash{}end\{equation\}}
\end{Highlighting}
\end{Shaded}
\begin{equation}
S(t) = \frac{S_{max}}{1 + e^{-(t-T_{i}) * r}} \label{eq:logistic}
\end{equation}
\hypertarget{assembling-your-thesis}{%
\section{Assembling your thesis}\label{assembling-your-thesis}}

Although the final product you obtain using \textbf{gaelsdown} will likely be a single document contained in one file, there are multiple files that go into creating this document. There's a simplicity to this in that each individual file has a specific function within the larger document, and I'll explain how you can customize the structure of your thesis by adding or removing certain files or sections.

\hypertarget{yaml-aint-markup-language}{%
\subsection{YAML Ain't Markup Language}\label{yaml-aint-markup-language}}

Every thesis generated using this template has an \textbf{index.Rmd} file. This is the file you use to knit the document, and it contains your \textbf{YAML} section (recursively named, ``YAML Ain't Markup Language''). Information from the \textbf{YAML} is passed onto \textbf{Pandoc}, and may include specifications for the output format and other options. You can also include \emph{frontmatter} material here, such as your abstract.

Open up \textbf{index.Rmd} in RStudio to see what the YAML looks like. It's the section at the beginning bracketed by three dashes:
\begin{Shaded}
\begin{Highlighting}[]
\SpecialCharTok{{-}{-}{-}}

\SpecialCharTok{{-}{-}{-}}
\end{Highlighting}
\end{Shaded}
Note: You need to be particularly attentive to the spaces in the YAML, so make sure when uncommenting lines you only remove the \texttt{\#} and not the spaces!

At the top of the YAML are some pieces of information that get passed along to the title page, such as the title and author name. Since the format for title pages are set for Queen's University, you'll want to change the answers to these entries, but not which lines are included (To change the format of the title page, you'd have to go into the .tex template).

Following this you'll find your \texttt{output} options. Here, you have the option of either PDF, gitbook (web page), Word, and EPUB; to change the format, just comment out the active line and uncomment the appropriate line. After this are lines for your introductory material: abstract, acknowledgements, glossary, etc. These sections are \emph{frontmatter}, will appear before the Table of Contents, are numbered with Roman instead of Arabic numerals, and won't be labelled as chapters.

Frontmatter is a bit quirky in that it needs to be read directly into LaTeX, so the frontmatter sections have to be defined in the .tex template and the YAML. I've defined all of the required and optional frontmatter sections specified for Queen's University theses, with some of them commented out. If you want to include frontmatter in another output format such as Word, then it has to be defined in the body of the .Rmd file, not the YAML.

After this are instructions for your references section. There's some defaults here for this document but you'll want to specify your own \textbf{bib} and \textbf{csl} file. The process for using these are the same as in \textbf{bookdown}, so for instructions on how to specify the \texttt{bibliography} and \texttt{csl} sections, follow Yihui Xie's tutorial \href{https://bookdown.org/yihui/rmarkdown-cookbook/bibliography.html}{here}.

\hypertarget{folders-and-files}{%
\subsection{Folders and files}\label{folders-and-files}}

Upon creating your \emph{gaelsdown} project in RStudio, your folder will have the following files and folders:

\hypertarget{bib}{%
\subsubsection{bib/}\label{bib}}

The .bib file lists the references that you use in your thesis, and the name of your .bib should be specified in the YAML.

\hypertarget{csl}{%
\subsubsection{csl/}\label{csl}}

The .csl file defines the formatting for references in your thesis, and .csl files matching the format for specific journals can be found online. The file name should also be specified in the YAML.

\hypertarget{data-and-figure}{%
\subsubsection{data/ and figure/}\label{data-and-figure}}

These are just folders for example data and figures; you can set the folders as you wish for other files (e.g.~a \texttt{R/} folder for scripts).

\hypertarget{bookdown.yml}{%
\subsubsection{\_bookdown.yml}\label{bookdown.yml}}

Configuration file for \textbf{bookdown}, the package underlying \textbf{gaelsdown}. You can change the output file and chapter prefixes here; see the \href{https://bookdown.org/yihui/bookdown/configuration.html}{bookdown reference} for more information.

\hypertarget{chap1.rmd-02-chap2.rmd}{%
\subsubsection{01-chap1.Rmd, 02-chap2.Rmd\ldots{}}\label{chap1.rmd-02-chap2.rmd}}

These are the main chapters of your thesis, which \textbf{gaelsdown} will join into one document. The .Rmd files in your main directory will all be knit together, so you can add as many files as you need and it's not necessary to follow this naming format (it just makes things easier to read).

\hypertarget{references.rmd}{%
\subsubsection{98-references.Rmd}\label{references.rmd}}

Your references come after every section apart from the appendices.

\hypertarget{appendix.rmd}{%
\subsubsection{99-appendix.Rmd}\label{appendix.rmd}}

The appendices come after the references. You can add as many appendix sections as necessary.

\hypertarget{prelims}{%
\subsubsection{prelims/}\label{prelims}}

Files for your abstract, acknowledgements, and other files can go in here so that they are not automatically knit like chapters but instead inserted ahead of the table of contents according to YAML instructions. I've written in if statements to check whether the output is LaTeX or not to decide how to insert these files.

\hypertarget{summary}{%
\section{Summary}\label{summary}}

In this section, I've covered markdown basics including text formatting, headers, and links. I've introduced how to add figures and tables to your thesis, how YAML is used to configure your output, and the different contents of your \emph{gaelsdown} project.

\hypertarget{workflow}{%
\chapter{Workflow}\label{workflow}}

In the previous chapter, I introduced the necessary basics for using \textbf{gaelsdown} to write your thesis: markdown language, YAML, and the document structure. In this chapter, I'll describe some recommended practices to integrate \textbf{gaelsdown} neatly into your thesis writing and some basic troubleshooting advice.

\hypertarget{data-files-and-scripts}{%
\section{Data files and scripts}\label{data-files-and-scripts}}

While your R markdown files will contain the text, tables, and figures for your thesis, you will likely have a workflow set up to process your raw data and generate your analyses. I recommend keeping this workflow separate as R scripts (.R file extension), generating data that will be used by the R markdown scripts read by \textbf{gaelsdown}. You can then tell your R scripts to produce data in the form of .csv or .RData, then read in these files in the R markdown along with code to generate figures and tables.

\hypertarget{targets-package}{%
\subsection{\texorpdfstring{\texttt{targets} package}{targets package}}\label{targets-package}}

An approach you may want to consider adopting is using \href{https://books.ropensci.org/targets/}{\texttt{targets}} (formerly \texttt{drake}) to organize your R workflow. This package works well with piped commands from \texttt{magrittr} used in tidyverse.

The advantage of using targets is that you can modify sections of your pipeline, and the function will automatically identify which computation needs to be run and which does not. Objects generated inside a targets function are written into a cache, and this works well with gaelsdown because those cached objects can be read into your R markdown files. You can do your data processing analysis using .R scripts, and only need to load that data and include the code in the R markdown files for generating your figures and tables.

You can find an interactive tutorial on how to use \texttt{targets} \href{https://github.com/wlandau/targets-tutorial}{here}.

\hypertarget{version-control}{%
\section{Version control}\label{version-control}}

With your \textbf{gaelsdown} thesis set up as a project, it's easy to integrate git into your workflow through RStudio. This will help you to identify errors when they're introduced (see troubleshooting) and can be used for collaboration. The easiest way is through GitHub.

With a \textbf{gaelsdown} project, you may not want to include all of the automatically-generated files in your git. Instead, you should set these files to be ignored in the .gitignore (more about setting gitignore):
\begin{itemize}
\tightlist
\item
  \_book/
\item
  \_bookdown\_files/
\end{itemize}
\hypertarget{troubleshooting}{%
\section{Troubleshooting}\label{troubleshooting}}

Perhaps the biggest challenge of working with \textbf{gaelsdown} comes from the fact that involves different software working together (see Figure \ref{fig:knit-diagram}). This means that errors can be introduced at different stages of your document assembly.

Thankfully, it's relatively easy to determine where the error is introduced, which helps a lot with resolving these errors. When you knit the index.Rmd, the rendering will follow a set sequence, so the source of the error will be apparent in the Render panel in RStudio (see Figure \ref{fig:knit-diagram}). You may need to check that your installations for requisite packages are up to date (such as rmarkdown, tinytex).

\hypertarget{r-errors}{%
\subsection{R errors}\label{r-errors}}

These are errors that prevent your R code from running, such as syntax errors missing functions.

\hypertarget{markdown-errors}{%
\subsection{Markdown errors}\label{markdown-errors}}

Markdown is not especially sensitive to errors, so faults are more likely to appear in your document.

\hypertarget{errors}{%
\subsection{\texorpdfstring{\LaTeX~errors}{~errors}}\label{errors}}

LaTeX errors may be introduced if you have modified the underlying .tex or .cls files, if you have inserted LaTeX commands directly into your markdown, or if you use functions that pass instructions onto LaTeX. If you encounter errors at this stage, a .tex file will have been generated which will help with identifying the source of the error.

\hypertarget{where-to-find-help}{%
\subsection{Where to find help}\label{where-to-find-help}}

There's a couple places you can look for help with \textbf{gaelsdown}. If you have identified a particular error, you can try to enter the error message or keywords into a web search and see if there are any entries. Some of these may point you to stackoverflow, a useful resource for tapping the expertise that is out there.

Additionally, you can seek help directly from the creators of this package (gaelsdown) and underlying packages (bookdown, thesisdown). Visit the github pages for these packages and take a look through existing issues. If you cannot find the issue described, submit an issue of your own!

\hypertarget{writing-environment-the-fun-part}{%
\section{Writing environment (the fun part)}\label{writing-environment-the-fun-part}}

Although being able to write your entire thesis using R markdown means you could write your whole thesis in RStudio, that doesn't mean you have to! However, a traditional document editor like Microsoft Word is not suited to editing markdown files (although there are now plugins available that you can try) since it will either leave your document unformatted or insert its own formatting code into your files. Instead, you can use a markdown editor to open your .Rmd files, which will recognize the formatting and provide a visually pleasing and focused environment for writing. These programs are available for free or a low cost, and I used \href{http://typora.io}{Typora} for my own thesis.

\hypertarget{getting-feedback-for-your-thesis}{%
\section{Getting feedback for your thesis}\label{getting-feedback-for-your-thesis}}

Because much of the formatting for the \textbf{gaelsdown} output relies on the TeX engine, HTML and Microsoft Word outputs will not reflect the finished product. However, Word documents are useful for tracking changes and if you are getting feedback from your supervisor on your thesis this way, you will have to manually enter the changes into your underlying .Rmd files. Additionally, knitting directly to a .doc file often results in issues with tables and figures. If you do need a .doc output, you may want to try knitting to a gitbook (HTML), then opening and saving the respective HTML files as word files.

\hypertarget{additional-functions}{%
\chapter{Additional functions}\label{additional-functions}}

This section is still in the works, and will describe some additional functions you may want to use when writing your thesis.

\hypertarget{kableextra}{%
\section{kableExtra}\label{kableextra}}

kableExtra adds functions to further customize tables that knitr's \texttt{kable()}
function generates in R markdown. Some useful functions include being able to
add footnotes (for example, to specific significance thresholds) or set
formatting for individual columns or rows in a table.

\hypertarget{writing-and-editing-tex}{%
\section{Writing and editing TeX}\label{writing-and-editing-tex}}

You can include expressions that would be rendered by TeX in your R markdown
document; just be aware that they will not be rendered if knitting into
other formats such as a gitbook or Word document.

Manual formatting commands such as \texttt{\textbackslash{}newpage}, \texttt{break}, or \texttt{\textbackslash{}textbf} can be
inserted in this way. However, if you find yourself needing to manually adjust
the position of page or line breaks, something may need to be reconfigured in
the underlying TeX template!

\hypertarget{formatting-figure-captions}{%
\section{Formatting figure captions}\label{formatting-figure-captions}}

Instead of writing the full figure caption in the R code chunk, you can enter
your caption in the body of the R markdown document following the expression
(ref:caption-name), then substitute the caption with (ref:caption-name). By
doing so, you can include code in the caption that you would otherwise not be
able to include, such as inline code or links to other sections of the document.

\hypertarget{conclusion}{%
\chapter*{Conclusion}\label{conclusion}}
\addcontentsline{toc}{chapter}{Conclusion}

This conclusion is a placeholder. If we don't want Conclusion to have a chapter number next to it, we can add the \texttt{\{-\}} attribute.

\hypertarget{more-info}{%
\section{More info}\label{more-info}}

And here's some other random info: the first paragraph after a chapter title or section head \emph{shouldn't be} indented, because indents are to tell the reader that you're starting a new paragraph. Since that's obvious after a chapter or section title, proper typesetting doesn't add an indent there.

\hypertarget{references}{%
\chapter*{References}\label{references}}
\addcontentsline{toc}{chapter}{References}

\markboth{References}{References}

\setlength{\parskip}{8pt}

\hypertarget{refs}{}
\begin{CSLReferences}{1}{0}
\leavevmode\vadjust pre{\hypertarget{ref-angel2000}{}}%
Angel, E. (2000). \emph{Interactive computer graphics : A top-down approach with OpenGL}. Boston, MA: Addison Wesley Longman.

\leavevmode\vadjust pre{\hypertarget{ref-angel2001}{}}%
Angel, E. (2001a). \emph{Batch-file computer graphics : A bottom-up approach with QuickTime}. Boston, MA: Wesley Addison Longman.

\leavevmode\vadjust pre{\hypertarget{ref-angel2002a}{}}%
Angel, E. (2001b). \emph{Test second book by angel}. Boston, MA: Wesley Addison Longman.

\end{CSLReferences}
\appendix

\hypertarget{further-resources}{%
\chapter{Further resources}\label{further-resources}}

For information on using R markdown with LaTeX, Yihui Xie's \href{https://bookdown.org/yihui/bookdown/}{bookdown guide} is fairly comprehensive.

If you want to integrate more TeX commands into your thesis, the \href{https://www.ctan.org/}{Comprehensive TeX Archive Network} is where you will find documentation on all the TeX packages available.

Chester Ismay's thesisdown included a guide (I've written this present guide in place of that one) that you can find \href{https://raw.githubusercontent.com/ismayc/thesisdown_book/master/thesis.pdf}{here}. You may also find Rosanna van Hespen's \href{https://rosannavanhespen.nl/category/rmarkdown/}{series of blogposts} on writing a thesis in R markdown useful, although Rosanna used limited LaTeX code and wrote it directly into the markdown files.

\hypertarget{the-second-appendix}{%
\chapter{The second appendix}\label{the-second-appendix}}

This second appendix includes all of the R chunks of code that were hidden throughout the document (using the \texttt{include\ =\ FALSE} chunk tag) to help with readability and/or setup.
\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# By default tinytex only compiles once; compiling multiple}
\CommentTok{\# times is necessary to ensure the List of Figures and List of Tables}
\CommentTok{\# page numbers are correct if listed in the Table of Contents}
\FunctionTok{options}\NormalTok{(}\AttributeTok{tinytex.compile.min\_times =} \DecValTok{3}\NormalTok{)}

\CommentTok{\# This chunk ensures that the gaelsdown package is}
\CommentTok{\# installed and loaded. This gaelsdown package includes}
\CommentTok{\# the template files for the thesis.}
\ControlFlowTok{if}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{require}\NormalTok{(devtools))}
  \FunctionTok{install.packages}\NormalTok{(}\StringTok{"devtools"}\NormalTok{, }\AttributeTok{repos =} \StringTok{"http://cran.rstudio.com"}\NormalTok{)}
\ControlFlowTok{if}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{require}\NormalTok{(gaelsdown))}
\NormalTok{  devtools}\SpecialCharTok{::}\FunctionTok{install\_github}\NormalTok{(}\StringTok{"eugenesit/gaelsdown"}\NormalTok{)}
\FunctionTok{library}\NormalTok{(gaelsdown)}
\ControlFlowTok{if}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{require}\NormalTok{(DiagrammeR))}
  \FunctionTok{install.packages}\NormalTok{(}\StringTok{"DiagrammeR"}\NormalTok{, }\AttributeTok{repos =} \StringTok{"http://cran.rstudio.com"}\NormalTok{)}
\FunctionTok{library}\NormalTok{(DiagrammeR)}
\ControlFlowTok{if}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{require}\NormalTok{(webshot))}
  \FunctionTok{install.packages}\NormalTok{(}\StringTok{"webshot"}\NormalTok{, }\AttributeTok{repos =} \StringTok{"http://cran.rstudio.com"}\NormalTok{)}
\FunctionTok{library}\NormalTok{(webshot)}
\ControlFlowTok{if}\NormalTok{(}\SpecialCharTok{!}\NormalTok{webshot}\SpecialCharTok{::}\FunctionTok{is\_phantomjs\_installed}\NormalTok{())}
\NormalTok{  webshot}\SpecialCharTok{::}\FunctionTok{install\_phantomjs}\NormalTok{()}
\ControlFlowTok{if}\NormalTok{(}\SpecialCharTok{!}\FunctionTok{require}\NormalTok{(kableExtra))}
  \FunctionTok{install.packages}\NormalTok{(}\StringTok{"kableExtra"}\NormalTok{, }\AttributeTok{repos =} \StringTok{"http://cran.rstudio.com"}\NormalTok{)}
\FunctionTok{library}\NormalTok{(kableExtra)}
\end{Highlighting}
\end{Shaded}
\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{DiagrammeR}\SpecialCharTok{::}\FunctionTok{grViz}\NormalTok{(}\StringTok{"}
\StringTok{                  digraph\{}
\StringTok{                  graph []}
\StringTok{                  node [shape = rectangle, fontname = \textquotesingle{}Courier New\textquotesingle{}, fontface = bold, style = filled]}
\StringTok{                    rmd [label = \textquotesingle{}R Markdown\textquotesingle{}, fillcolor = \textquotesingle{}\#fbb4ae\textquotesingle{}]}
\StringTok{                    knitr [label = \textquotesingle{}knitr\textquotesingle{}, shape = ellipse, fillcolor = \textquotesingle{}\#ffffcc\textquotesingle{}]}
\StringTok{                    pandoc [label = \textquotesingle{}pandoc\textquotesingle{}, shape = ellipse, fillcolor = \textquotesingle{}\#ffffcc\textquotesingle{}]}
\StringTok{                    word [label = \textquotesingle{}MS Word\textquotesingle{}, fillcolor = \textquotesingle{}\#ccebc5\textquotesingle{}]}
\StringTok{                    epub [label = \textquotesingle{}EPUB\textquotesingle{}, fillcolor = \textquotesingle{}\#ccebc5\textquotesingle{}]}
\StringTok{                    html [label = \textquotesingle{}gitpages\textquotesingle{}, fillcolor = \textquotesingle{}\#ccebc5\textquotesingle{}]}
\StringTok{                    blank [shape = point, width = 0, height = 0]}
\StringTok{                    img [label = \textquotesingle{}graphics\textquotesingle{}, shape = polygon, sides = 6, fillcolor = \textquotesingle{}\#decbe4\textquotesingle{}]}
\StringTok{                    md [label = \textquotesingle{}markdown\textquotesingle{}, shape = polygon, sides = 6, fillcolor = \textquotesingle{}\#decbe4\textquotesingle{}]}
\StringTok{                    tex [label = \textquotesingle{}tex\textquotesingle{}, shape = polygon, sides = 6, fillcolor = \textquotesingle{}\#decbe4\textquotesingle{}]}
\StringTok{                    engine [label = \textquotesingle{}tinytex\textquotesingle{}, shape = ellipse, fillcolor = \textquotesingle{}\#ffffcc\textquotesingle{}]}
\StringTok{                    pdf [label = \textquotesingle{}PDF\textquotesingle{}, fillcolor = \textquotesingle{}\#ccebc5\textquotesingle{}]}
\StringTok{                    style [label = \textquotesingle{}LaTeX}\SpecialCharTok{\textbackslash{}n}\StringTok{template\textquotesingle{}, fillcolor = \textquotesingle{}\#fed9a6\textquotesingle{}]}
\StringTok{                  edge []}
\StringTok{                    rmd {-}\textgreater{} knitr}
\StringTok{                    knitr {-}\textgreater{} md}
\StringTok{                    knitr {-}\textgreater{} img}
\StringTok{                    md {-}\textgreater{} pandoc}
\StringTok{                    img {-}\textgreater{} pandoc}
\StringTok{                    pandoc {-}\textgreater{} blank [arrowhead = none]}
\StringTok{                    pandoc {-}\textgreater{} word}
\StringTok{                    pandoc {-}\textgreater{} epub}
\StringTok{                    pandoc {-}\textgreater{} html}
\StringTok{                    tex {-}\textgreater{} engine}
\StringTok{                    style {-}\textgreater{} blank [arrowhead = none]}
\StringTok{                    blank {-}\textgreater{} tex}
\StringTok{                    engine {-}\textgreater{} pdf}
\StringTok{                    \{ rank = same; word, epub, html, tex \}}
\StringTok{                  \}"}\NormalTok{, }\AttributeTok{width =} \DecValTok{500}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\end{document}
